hosts:
    - address:
      port: 22
      username:
      password:
      apply:
        - helloworld
    - address:
      port: 22
      username: root
      password:
      apply:
        - helloworld


handlers:
    restart_httpd:
        module_name: service
        action: restart
        service_name: lighttpd

configurations:
    helloworld:
        - module_name: package
          state: present
          package_name: lighttpd
        - module_name: package
          state: present
          package_name: php-cgi
        - module_name: exec
          command:  lighty-enable-mod fastcgi fastcgi-php
          post-run: restart_httpd
        - module_name: file
          content: |
            <?php
            header("Content-Type: text/plain");
            echo "Hello, world!\n";
            ?>
          path: /var/www/html/index.php
          owner: 
          group:
          mode: 

$PACKAGE=lighttpd

if  [ "x$(aptitude -q=10 search -F %p '~i ?name(^lighttpd$)')" == "xlightpd"  ]; then 
  apt-get install lighttpd php-cgi
fi


# EXEC
lighty-enable-mod fastcgi fastcgi-php

# Restart
systemctl restart lighttpd

PATH=/var/www/html/index.php

cat > $FILE_PATH << EOF
<?php
header("Content-Type: text/plain");
echo "Hello, world!\n";
?>
EOF

chown $FILE
chmod $FILE
